---
import BaseLayout from "../layouts/BaseLayout.astro";
import Alert from "../components/ui/Alert.astro";
import Card from "../components/ui/Card.astro";
import Footnote from "../components/ui/Footnote.astro";
import { funding } from "../content/funding";
import { fundingRefs, toList } from "../content/references";
---

<BaseLayout title="Funding Guide — Project Phoenix" description="NSFAS, Funza Lushaka, University bursaries, and learnerships—what you qualify for and how to apply.">
  <section class="mb-8 text-center space-y-3">
    <h1 class="font-display text-3xl sm:text-4xl md:text-5xl font-bold text-gradient italic">Your Financial Guide</h1>
    <p class="text-neutral/80 max-w-2xl mx-auto">
      Understand funding pathways and prepare an application that’s complete, early, and stress‑free.
    </p>
  </section>

  <section class="mb-10 grid gap-6 lg:grid-cols-2">
    <div class="rounded-xl border border-base-300 bg-gradient-to-br from-blue-50 to-indigo-50 p-6">
      <h2 class="font-display text-xl font-semibold mb-4 text-neutral">{funding.nsfas.title}</h2>
      <div class="space-y-4 text-sm text-neutral/80">
        <div class="rounded-lg border border-blue-200 bg-white p-4">
          <h3 class="font-medium text-neutral mb-2">Eligibility</h3>
          <ul class="list-disc ml-5 space-y-1">
            {funding.nsfas.eligibility.map((e) => (
              <li>{e.text}</li>
            ))}
          </ul>
          {funding.nsfas.goodNewsRef && (
            <p class="text-xs text-neutral/60 mt-2">
              See application requirements.
              <Footnote id={funding.nsfas.goodNewsRef} tooltip="NSFAS requirements" />
            </p>
          )}
        </div>

        <Alert variant="success" title="Good news" class="!p-4">
          {funding.nsfas.goodNewsNote}
          {funding.nsfas.goodNewsRef && (
            <Footnote id={funding.nsfas.goodNewsRef} tooltip="NSFAS requirements" />
          )}
        </Alert>
      </div>
    </div>

    <div class="rounded-xl border border-base-300 bg-gradient-to-br from-emerald-50 to-green-50 p-6">
      <h2 class="font-display text-xl font-semibold mb-4 text-neutral">Other Funding Avenues</h2>
      <div class="space-y-4 text-sm text-neutral/80">
        <div class="rounded-lg border border-green-200 bg-white p-4">
          <h3 class="font-medium text-neutral mb-1">{funding.otherAvenues.funza.title}</h3>
          <p>{funding.otherAvenues.funza.description}</p>
          {funding.otherAvenues.funza.refId && (
            <p class="text-xs text-neutral/60 mt-2">
              <Footnote id={funding.otherAvenues.funza.refId} tooltip="Funza Lushaka" />
            </p>
          )}
        </div>

        <div class="rounded-lg border border-green-200 bg-white p-4">
          <h3 class="font-medium text-neutral mb-1">{funding.otherAvenues.universityBursaries.title}</h3>
          <p>{funding.otherAvenues.universityBursaries.description}</p>
        </div>

        <div class="rounded-lg border border-green-200 bg-white p-4">
          <h3 class="font-medium text-neutral mb-1">{funding.otherAvenues.learnerships.title}</h3>
          <p>{funding.otherAvenues.learnerships.description}</p>
        </div>
      </div>
    </div>
  </section>

  <section class="mb-12 rounded-xl border border-base-300 bg-white p-6">
    <h2 class="font-display text-xl font-semibold mb-4">Choosing Your Institution: At a Glance</h2>
    <div class="overflow-x-auto">
      <table class="w-full border-collapse border border-base-300 text-sm">
        <thead>
          <tr class="bg-base-200">
            <th scope="col" class="border border-base-300 p-3 text-left font-semibold">Institution Type</th>
            <th scope="col" class="border border-base-300 p-3 text-left font-semibold">Focus</th>
            <th scope="col" class="border border-base-300 p-3 text-left font-semibold">Qualifications</th>
            <th scope="col" class="border border-base-300 p-3 text-left font-semibold">Learning Style</th>
            <th scope="col" class="border border-base-300 p-3 text-left font-semibold">Best For</th>
          </tr>
        </thead>
        <tbody>
          {funding.institutionComparison.rows.map((row, idx) => (
            <tr class={idx % 3 === 0 ? "bg-blue-50" : idx % 3 === 1 ? "bg-green-50" : "bg-purple-50"}>
              <td class="border border-base-300 p-3 font-medium">{row.type}</td>
              <td class="border border-base-300 p-3">{row.focus}</td>
              <td class="border border-base-300 p-3">{row.qualifications}</td>
              <td class="border border-base-300 p-3">{row.learningStyle}</td>
              <td class="border border-base-300 p-3">{row.bestFor}</td>
            </tr>
          ))}
        </tbody>
        </table>
    </div>
  </section>

  <section class="mb-12">
    <h2 class="font-display text-xl font-semibold mb-3">NSFAS Application Checklist</h2>
    <div class="grid gap-6 md:grid-cols-2">
      <Card accent="blue">
        <ul class="list-disc ml-5 space-y-1 text-sm text-neutral/80">
          {funding.nsfasChecklist.left.map((i) => (
            <li>{i.label}</li>
          ))}
        </ul>
      </Card>
      <Card accent="green">
        <ul class="list-disc ml-5 space-y-1 text-sm text-neutral/80">
          {funding.nsfasChecklist.right.map((i) => (
            <li>{i.label}</li>
          ))}
        </ul>
      </Card>
    </div>
  </section>

  <section id="references" class="mt-8">
    <h3 class="font-display text-xl font-semibold mb-3">References</h3>
    <ol class="list-decimal ml-5 space-y-1 text-sm text-neutral/80">
      {toList(fundingRefs).map((r) => (
        <li id={`ref-${r.id}`}>
          <a class="text-primary" href={r.url}>{r.title}</a>
        </li>
      ))}
    </ol>
  </section>
</BaseLayout>
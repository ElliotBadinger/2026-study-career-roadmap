import{j as t}from"./jsx-runtime.TBa3i5EZ.js";import{r as o}from"./index.CVf8TyFT.js";const T="phoenix-decision-matrix-v1";function u(n){const p=Number(n);return Number.isFinite(p)?Math.max(1,Math.min(5,Math.round(p))):0}function i(n){return u(n.interest)+u(n.skills)+u(n.demand)}function v(){return[{id:"ex-1",name:"Foundation Phase Teacher",interest:4,skills:4,demand:5,qualification:"B.Ed Degree",funding:"Funza Lushaka"},{id:"ex-2",name:"Human Resources Officer",interest:3,skills:3,demand:4,qualification:"Diploma/Degree",funding:"NSFAS"}].map(n=>({...n,total:i(n)}))}function M({storageKey:n=T,title:p="Career Decision Matrix",defaultRows:d=[]}){const[c,l]=o.useState(()=>{try{const e=localStorage.getItem(n);if(e){const a=JSON.parse(e);if(Array.isArray(a))return a.map(r=>({...r,total:i(r)}))}}catch{}return Array.isArray(d)&&d.length?d.map((e,a)=>{const s={id:e.id||`seed-${a}`,name:e.name||"Your Option",interest:Number.isFinite(e.interest)?e.interest:3,skills:Number.isFinite(e.skills)?e.skills:3,demand:Number.isFinite(e.demand)?e.demand:3,qualification:e.qualification??"",funding:e.funding??""};return{...s,total:i(s)}}):v()}),[x,w]=o.useState("total"),[h,S]=o.useState("desc"),[f,k]=o.useState("all"),[N,g]=o.useState(""),j=o.useRef(null);o.useEffect(()=>{try{localStorage.setItem(n,JSON.stringify(c))}catch{}},[c,n]);const y=o.useMemo(()=>{let e=[...c];if(e.sort((a,r)=>{const s=h==="asc"?1:-1;return x==="name"?a.name.localeCompare(r.name)*s:(a.total-r.total)*s}),f==="top"){const a=e.length?Math.max(...e.map(r=>r.total)):0;e=e.filter(r=>r.total===a)}return e},[c,x,h,f]);function b(e,a){l(r=>r.map(s=>{if(s.id!==e)return s;const m={...s,...a};return m.total=i(m),m}))}function C(e){l(a=>a.filter(r=>r.id!==e))}function O(){const e=globalThis.crypto&&crypto.randomUUID&&crypto.randomUUID()||`${Date.now()}-${Math.random().toString(36).slice(2,8)}`;l(a=>[...a,{id:e,name:"Your Option",interest:3,skills:3,demand:3,qualification:"",funding:"",total:9}])}async function F(){try{const e=JSON.stringify(c,null,2);await navigator.clipboard.writeText(e),alert("Decision Matrix copied to clipboard.")}catch{alert("Copy failed. Use Export Download instead.")}}function A(){const e=JSON.stringify(c,null,2),a=new Blob([e],{type:"application/json"}),r=URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.download="decision-matrix.json",s.click(),URL.revokeObjectURL(r)}function I(){try{const e=JSON.parse(N);if(!Array.isArray(e))throw new Error("Invalid format");l(e.map(a=>({...a,total:i(a)}))),g(""),alert("Imported successfully.")}catch(e){alert("Import failed: "+(e?.message||"Invalid JSON"))}}function D(e){const a=e.target.files?.[0];if(!a)return;const r=new FileReader;r.onload=()=>{try{const s=JSON.parse(String(r.result));if(!Array.isArray(s))throw new Error("Invalid format");l(s.map(m=>({...m,total:i(m)}))),j.current.value=""}catch(s){alert("Import failed: "+(s?.message||"Invalid JSON"))}},r.readAsText(a)}function J(){Array.isArray(d)&&d.length?l(d.map((e,a)=>{const s={id:e.id||`seed-${a}`,name:e.name||"Your Option",interest:Number.isFinite(e.interest)?e.interest:3,skills:Number.isFinite(e.skills)?e.skills:3,demand:Number.isFinite(e.demand)?e.demand:3,qualification:e.qualification??"",funding:e.funding??""};return{...s,total:i(s)}})):l(v())}return t.jsxs("section",{className:"rounded-xl border border-base-300 bg-white p-5 sm:p-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[t.jsx("h2",{className:"font-display text-lg sm:text-xl font-semibold text-neutral",children:p}),t.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[t.jsxs("div",{className:"flex items-center gap-1 border border-base-300 rounded px-2 py-1",children:[t.jsx("label",{className:"text-neutral/70",children:"Sort"}),t.jsxs("select",{className:"bg-white outline-none",value:x,onChange:e=>w(e.target.value),"aria-label":"Sort column",children:[t.jsx("option",{value:"total",children:"Total"}),t.jsx("option",{value:"name",children:"Name"})]}),t.jsx("button",{type:"button",className:"px-2 py-0.5 rounded border border-base-300 hover:bg-base-200",onClick:()=>S(e=>e==="asc"?"desc":"asc"),"aria-label":"Toggle sort direction",title:"Toggle sort direction",children:h==="asc"?"↑":"↓"})]}),t.jsxs("div",{className:"flex items-center gap-1 border border-base-300 rounded px-2 py-1",children:[t.jsx("label",{className:"text-neutral/70",children:"Filter"}),t.jsxs("select",{className:"bg-white outline-none",value:f,onChange:e=>k(e.target.value),"aria-label":"Filter rows",children:[t.jsx("option",{value:"all",children:"All"}),t.jsx("option",{value:"top",children:"Top score"})]})]}),t.jsx("button",{type:"button",className:"px-3 py-1.5 rounded border border-base-300 hover:bg-base-200",onClick:O,children:"Add row"}),t.jsx("button",{type:"button",className:"px-3 py-1.5 rounded border border-base-300 hover:bg-base-200",onClick:F,children:"Copy JSON"}),t.jsx("button",{type:"button",className:"px-3 py-1.5 rounded border border-base-300 hover:bg-base-200",onClick:A,children:"Export"}),t.jsxs("label",{className:"px-3 py-1.5 rounded border border-base-300 hover:bg-base-200 cursor-pointer",children:["Import",t.jsx("input",{ref:j,onChange:D,type:"file",accept:"application/json",className:"hidden","aria-label":"Import Decision Matrix JSON"})]}),t.jsx("button",{type:"button",className:"px-3 py-1.5 rounded border border-base-300 hover:bg-base-200",onClick:J,children:"Reset examples"})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse border border-base-300 text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-base-200",children:[t.jsx("th",{scope:"col",className:"border border-base-300 p-2 text-left font-semibold",children:"Career Option"}),t.jsx("th",{scope:"col",className:"border border-base-300 p-2 text-center font-semibold",children:"Interest (1-5)"}),t.jsx("th",{scope:"col",className:"border border-base-300 p-2 text-center font-semibold",children:"Skills Match (1-5)"}),t.jsx("th",{scope:"col",className:"border border-base-300 p-2 text-center font-semibold",children:"Job Demand (1-5)"}),t.jsx("th",{scope:"col",className:"border border-base-300 p-2 text-left font-semibold",children:"Qualification"}),t.jsx("th",{scope:"col",className:"border border-base-300 p-2 text-center font-semibold",children:"Funding"}),t.jsx("th",{scope:"col",className:"border border-base-300 p-2 text-center font-semibold",children:"Total"}),t.jsx("th",{scope:"col",className:"border border-base-300 p-2 text-center font-semibold",children:"Remove"})]})}),t.jsxs("tbody",{children:[y.map(e=>t.jsxs("tr",{className:"odd:bg-white even:bg-base-100",children:[t.jsx("td",{className:"border border-base-300 p-2",children:t.jsx("input",{type:"text",value:e.name,onChange:a=>b(e.id,{name:a.target.value}),className:"w-full bg-transparent outline-none","aria-label":"Career Option"})}),t.jsx("td",{className:"border border-base-300 p-2 text-center",children:t.jsx("input",{type:"number",min:1,max:5,value:e.interest,onChange:a=>b(e.id,{interest:u(a.target.value)}),className:"w-16 text-center bg-white border border-base-300 rounded","aria-label":"Interest score"})}),t.jsx("td",{className:"border border-base-300 p-2 text-center",children:t.jsx("input",{type:"number",min:1,max:5,value:e.skills,onChange:a=>b(e.id,{skills:u(a.target.value)}),className:"w-16 text-center bg-white border border-base-300 rounded","aria-label":"Skills Match score"})}),t.jsx("td",{className:"border border-base-300 p-2 text-center",children:t.jsx("input",{type:"number",min:1,max:5,value:e.demand,onChange:a=>b(e.id,{demand:u(a.target.value)}),className:"w-16 text-center bg-white border border-base-300 rounded","aria-label":"Job Demand score"})}),t.jsx("td",{className:"border border-base-300 p-2",children:t.jsx("input",{type:"text",value:e.qualification??"",onChange:a=>b(e.id,{qualification:a.target.value}),className:"w-full bg-transparent outline-none","aria-label":"Qualification",placeholder:"e.g., Diploma, B.Ed"})}),t.jsx("td",{className:"border border-base-300 p-2 text-center",children:t.jsx("input",{type:"text",value:e.funding??"",onChange:a=>b(e.id,{funding:a.target.value}),className:"w-full bg-transparent outline-none text-center","aria-label":"Funding",placeholder:"NSFAS / Funza"})}),t.jsx("td",{className:"border border-base-300 p-2 text-center font-semibold text-primary",children:e.total}),t.jsx("td",{className:"border border-base-300 p-2 text-center",children:t.jsx("button",{type:"button",onClick:()=>C(e.id),"aria-label":`Remove ${e.name}`,className:"text-xs px-2 py-1 rounded border border-base-300 hover:bg-base-200",children:"Remove"})})]},e.id)),y.length===0&&t.jsx("tr",{children:t.jsx("td",{className:"border border-base-300 p-3 text-center text-neutral/60",colSpan:8,children:"No rows. Click “Add row” to begin."})})]})]})}),t.jsxs("details",{className:"mt-4",children:[t.jsx("summary",{className:"text-sm cursor-pointer select-none",children:"Paste JSON to import"}),t.jsxs("div",{className:"mt-2",children:[t.jsx("textarea",{value:N,onChange:e=>g(e.target.value),className:"w-full h-28 text-xs border border-base-300 rounded p-2",placeholder:'[{"id":"1","name":"Example","interest":4,"skills":4,"demand":5,"qualification":"","funding":""}]'}),t.jsxs("div",{className:"mt-2 flex gap-2",children:[t.jsx("button",{type:"button",onClick:I,className:"px-3 py-1.5 rounded border border-base-300 hover:bg-base-200 text-xs",children:"Import from text"}),t.jsx("button",{type:"button",onClick:()=>g(""),className:"px-3 py-1.5 rounded border border-base-300 hover:bg-base-200 text-xs",children:"Clear"})]})]})]})]})}export{M as default};

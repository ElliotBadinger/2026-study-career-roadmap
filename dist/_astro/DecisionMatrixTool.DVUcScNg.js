import{j as e}from"./jsx-runtime.TBa3i5EZ.js";import{r as n}from"./index.CVf8TyFT.js";const T="phoenix-decision-matrix-v1";function g(o){const p=Number(o);return Number.isFinite(p)?Math.max(1,Math.min(5,Math.round(p))):0}function l(o){return g(o.interest)+g(o.skills)+g(o.demand)}function j(){return[{id:"ex-1",name:"Foundation Phase Teacher",interest:4,skills:4,demand:5,qualification:"B.Ed Degree",funding:"Funza Lushaka"},{id:"ex-2",name:"Human Resources Officer",interest:3,skills:3,demand:4,qualification:"Diploma/Degree",funding:"NSFAS"}].map(o=>({...o,total:l(o)}))}function M({storageKey:o=T,title:p="Career Decision Matrix",defaultRows:s=[]}){const[b,i]=n.useState(()=>{try{const r=localStorage.getItem(o);if(r){const t=JSON.parse(r);if(Array.isArray(t))return t.map(a=>({...a,total:l(a)}))}}catch{}return Array.isArray(s)&&s.length?s.map((r,t)=>{const d={id:r.id||`seed-${t}`,name:r.name||"Your Option",interest:Number.isFinite(r.interest)?r.interest:3,skills:Number.isFinite(r.skills)?r.skills:3,demand:Number.isFinite(r.demand)?r.demand:3,qualification:r.qualification??"",funding:r.funding??""};return{...d,total:l(d)}}):j()}),[h,v]=n.useState("total"),[u,S]=n.useState("desc"),[x,w]=n.useState("all"),[f,k]=n.useState(""),y=n.useRef(null);n.useEffect(()=>{try{localStorage.setItem(o,JSON.stringify(b))}catch{}},[b,o]);const N=n.useMemo(()=>{let r=[...b];if(r.sort((t,a)=>{const d=u==="asc"?1:-1;return h==="name"?t.name.localeCompare(a.name)*d:(t.total-a.total)*d}),x==="top"){const t=r.length?Math.max(...r.map(a=>a.total)):0;r=r.filter(a=>a.total===t)}return r},[b,h,u,x]);function c(r,t){i(a=>a.map(d=>{if(d.id!==r)return d;const m={...d,...t};return m.total=l(m),m}))}function C(r){i(t=>t.filter(a=>a.id!==r))}function O(){const r=globalThis.crypto&&crypto.randomUUID&&crypto.randomUUID()||`${Date.now()}-${Math.random().toString(36).slice(2,8)}`;i(t=>[...t,{id:r,name:"Your Option",interest:3,skills:3,demand:3,qualification:"",funding:"",total:9}])}async function F(){try{const r=JSON.stringify(b,null,2);await navigator.clipboard.writeText(r),alert("Decision Matrix copied to clipboard.")}catch{alert("Copy failed. Use Export Download instead.")}}function A(){const r=JSON.stringify(b,null,2),t=new Blob([r],{type:"application/json"}),a=URL.createObjectURL(t),d=document.createElement("a");d.href=a,d.download="decision-matrix.json",d.click(),URL.revokeObjectURL(a)}function I(){try{const r=JSON.parse(f);if(!Array.isArray(r))throw new Error("Invalid format");i(r.map(t=>({...t,total:l(t)}))),k(""),alert("Imported successfully.")}catch(r){alert("Import failed: "+(r?.message||"Invalid JSON"))}}function D(r){const t=r.target.files?.[0];if(!t)return;const a=new FileReader;a.onload=()=>{try{const d=JSON.parse(String(a.result));if(!Array.isArray(d))throw new Error("Invalid format");i(d.map(m=>({...m,total:l(m)}))),y.current.value=""}catch(d){alert("Import failed: "+(d?.message||"Invalid JSON"))}},a.readAsText(t)}function J(){Array.isArray(s)&&s.length?i(s.map((r,t)=>{const d={id:r.id||`seed-${t}`,name:r.name||"Your Option",interest:Number.isFinite(r.interest)?r.interest:3,skills:Number.isFinite(r.skills)?r.skills:3,demand:Number.isFinite(r.demand)?r.demand:3,qualification:r.qualification??"",funding:r.funding??""};return{...d,total:l(d)}})):i(j())}return e.jsxs("section",{className:"rounded-xl border border-border-light bg-bg-light-primary dark:border-border-dark dark:bg-bg-dark-surface p-5 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[e.jsx("h2",{className:"font-display text-lg sm:text-xl font-semibold text-text-light-primary dark:text-text-dark-primary",children:p}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 border border-border-light dark:border-border-dark rounded px-2 py-1",children:[e.jsx("label",{className:"text-text-light-secondary dark:text-text-dark-secondary",children:"Sort"}),e.jsxs("select",{className:"bg-bg-light-primary dark:bg-bg-dark-surface outline-none",value:h,onChange:r=>v(r.target.value),"aria-label":"Sort column",children:[e.jsx("option",{value:"total",children:"Total"}),e.jsx("option",{value:"name",children:"Name"})]}),e.jsx("button",{type:"button",className:"px-2 py-0.5 rounded border border-border-light hover:bg-bg-light-secondary dark:border-border-dark dark:hover:bg-bg-dark-primary",onClick:()=>S(r=>r==="asc"?"desc":"asc"),"aria-label":"Toggle sort direction",title:"Toggle sort direction",children:u==="asc"?"↑":"↓"})]}),e.jsxs("div",{className:"flex items-center gap-1 border border-border-light dark:border-border-dark rounded px-2 py-1",children:[e.jsx("label",{className:"text-text-light-secondary dark:text-text-dark-secondary",children:"Filter"}),e.jsxs("select",{className:"bg-bg-light-primary dark:bg-bg-dark-surface outline-none",value:x,onChange:r=>w(r.target.value),"aria-label":"Filter rows",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"top",children:"Top score"})]})]}),e.jsx("button",{type:"button",className:"px-3 py-1.5 rounded border border-border-light hover:bg-bg-light-secondary dark:border-border-dark dark:hover:bg-bg-dark-primary",onClick:O,children:"Add row"}),e.jsx("button",{type:"button",className:"px-3 py-1.5 rounded border border-border-light hover:bg-bg-light-secondary dark:border-border-dark dark:hover:bg-bg-dark-primary",onClick:F,children:"Copy JSON"}),e.jsx("button",{type:"button",className:"px-3 py-1.5 rounded border border-border-light hover:bg-bg-light-secondary dark:border-border-dark dark:hover:bg-bg-dark-primary",onClick:A,children:"Export"}),e.jsxs("label",{className:"px-3 py-1.5 rounded border border-border-light hover:bg-bg-light-secondary dark:border-border-dark dark:hover:bg-bg-dark-primary cursor-pointer",children:["Import",e.jsx("input",{ref:y,onChange:D,type:"file",accept:"application/json",className:"hidden","aria-label":"Import Decision Matrix JSON"})]}),e.jsx("button",{type:"button",className:"px-3 py-1.5 rounded border border-border-light hover:bg-bg-light-secondary dark:border-border-dark dark:hover:bg-bg-dark-primary",onClick:J,children:"Reset examples"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border border-border-light dark:border-border-dark text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-bg-light-secondary dark:bg-bg-dark-primary",children:[e.jsx("th",{scope:"col",className:"border border-border-light dark:border-border-dark p-2 text-left font-semibold",children:"Career Option"}),e.jsx("th",{scope:"col",className:"border border-border-light dark:border-border-dark p-2 text-center font-semibold",children:"Interest (1-5)"}),e.jsx("th",{scope:"col",className:"border border-border-light dark:border-border-dark p-2 text-center font-semibold",children:"Skills Match (1-5)"}),e.jsx("th",{scope:"col",className:"border border-border-light dark:border-border-dark p-2 text-center font-semibold",children:"Job Demand (1-5)"}),e.jsx("th",{scope:"col",className:"border border-border-light dark:border-border-dark p-2 text-left font-semibold",children:"Qualification"}),e.jsx("th",{scope:"col",className:"border border-border-light dark:border-border-dark p-2 text-center font-semibold",children:"Funding"}),e.jsx("th",{scope:"col",className:"border border-border-light dark:border-border-dark p-2 text-center font-semibold",children:"Total"}),e.jsx("th",{scope:"col",className:"border border-border-light dark:border-border-dark p-2 text-center font-semibold",children:"Remove"})]})}),e.jsxs("tbody",{children:[N.map(r=>e.jsxs("tr",{className:"odd:bg-bg-light-primary even:bg-bg-light-secondary dark:odd:bg-bg-dark-surface dark:even:bg-bg-dark-primary",children:[e.jsx("td",{className:"border border-border-light dark:border-border-dark p-2",children:e.jsx("input",{type:"text",value:r.name,onChange:t=>c(r.id,{name:t.target.value}),className:"w-full bg-transparent outline-none","aria-label":"Career Option"})}),e.jsx("td",{className:"border border-border-light dark:border-border-dark p-2 text-center",children:e.jsx("input",{type:"number",min:1,max:5,value:r.interest,onChange:t=>c(r.id,{interest:g(t.target.value)}),className:"w-16 text-center bg-bg-light-primary dark:bg-bg-dark-surface border border-border-light dark:border-border-dark rounded","aria-label":"Interest score"})}),e.jsx("td",{className:"border border-border-light dark:border-border-dark p-2 text-center",children:e.jsx("input",{type:"number",min:1,max:5,value:r.skills,onChange:t=>c(r.id,{skills:g(t.target.value)}),className:"w-16 text-center bg-bg-light-primary dark:bg-bg-dark-surface border border-border-light dark:border-border-dark rounded","aria-label":"Skills Match score"})}),e.jsx("td",{className:"border border-border-light dark:border-border-dark p-2 text-center",children:e.jsx("input",{type:"number",min:1,max:5,value:r.demand,onChange:t=>c(r.id,{demand:g(t.target.value)}),className:"w-16 text-center bg-bg-light-primary dark:bg-bg-dark-surface border border-border-light dark:border-border-dark rounded","aria-label":"Job Demand score"})}),e.jsx("td",{className:"border border-border-light dark:border-border-dark p-2",children:e.jsx("input",{type:"text",value:r.qualification??"",onChange:t=>c(r.id,{qualification:t.target.value}),className:"w-full bg-transparent outline-none","aria-label":"Qualification",placeholder:"e.g., Diploma, B.Ed"})}),e.jsx("td",{className:"border border-border-light dark:border-border-dark p-2 text-center",children:e.jsx("input",{type:"text",value:r.funding??"",onChange:t=>c(r.id,{funding:t.target.value}),className:"w-full bg-transparent outline-none text-center","aria-label":"Funding",placeholder:"NSFAS / Funza"})}),e.jsx("td",{className:"border border-border-light dark:border-border-dark p-2 text-center font-semibold text-primary",children:r.total}),e.jsx("td",{className:"border border-border-light dark:border-border-dark p-2 text-center",children:e.jsx("button",{type:"button",onClick:()=>C(r.id),"aria-label":`Remove ${r.name}`,className:"text-xs px-2 py-1 rounded border border-border-light hover:bg-bg-light-secondary dark:border-border-dark dark:hover:bg-bg-dark-primary",children:"Remove"})})]},r.id)),N.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"border border-border-light dark:border-border-dark p-3 text-center text-text-light-secondary dark:text-text-dark-secondary",colSpan:8,children:"No rows. Click “Add row” to begin."})})]})]})}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"text-sm cursor-pointer select-none",children:"Paste JSON to import"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("textarea",{value:f,onChange:r=>k(r.target.value),className:"w-full h-28 text-xs border border-border-light dark:border-border-dark rounded p-2 bg-bg-light-secondary dark:bg-bg-dark-primary",placeholder:'[{"id":"1","name":"Example","interest":4,"skills":4,"demand":5,"qualification":"","funding":""}]'}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("button",{type:"button",onClick:I,className:"px-3 py-1.5 rounded border border-border-light hover:bg-bg-light-secondary dark:border-border-dark dark:hover:bg-bg-dark-primary text-xs",children:"Import from text"}),e.jsx("button",{type:"button",onClick:()=>k(""),className:"px-3 py-1.5 rounded border border-border-light hover:bg-bg-light-secondary dark:border-border-dark dark:hover:bg-bg-dark-primary text-xs",children:"Clear"})]})]})]})]})}export{M as default};
